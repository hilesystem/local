"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("node:fs/promises"),t=require("node:path"),r=require("node:fs"),i=require("node:crypto"),s=_interopDefault(require("os")),n=_interopDefault(require("fs")),a=_interopDefault(require("node:assert"));async function createDirectory(t,r="0777",i=!0){try{return await e.mkdir(t,{mode:r,recursive:i}),!0}catch(e){return e}}async function getStatus(t){try{return[await e.stat(t)]}catch(e){return[void 0,e]}}async function writeFile(t,r,i){try{return await e.writeFile(t,r,i),!0}catch(e){return e}}async function createFile(r,i="0777"){const[s,n]=await getStatus(r);if(!n&&s.isFile())return!0;const a=t.dirname(r);if(n&&"ENOENT"===n.code){const e=await createDirectory(a,i);if(!0!==e)return e;const t=await writeFile(r,"",{mode:i,flag:"w"});return!0===t||t}if(s.isDirectory())return await writeFile(r,"",{mode:i,flag:"w"});try{return void await e.readdir(a)}catch(n){return n}}async function accessWrapper(t,r){try{return await e.access(r,t),!0}catch(e){return e}}async function dirIsReadable(e){return accessWrapper(r.constants.R_OK,e)}const o=new RegExp(["^npm-debug\\.log$","^\\..*\\.swp$","^\\.DS_Store$","^\\.AppleDouble$","^\\.LSOverride$","^Icon\\r$","^\\._.*","^\\.Spotlight-V100(?:$|\\/)","\\.Trashes","^__MACOSX$","~$","^Thumbs\\.db$","^ehthumbs\\.db$","^Desktop\\.ini$","@eaDir$","^\\$RECYCLE.BIN$","^System Volume Information$"].join("|"));function isNotSystemJunk(e){return!function isSystemJunk(e){return o.test(e)}(e)}async function listContents(t,r=!0){try{const i=await e.readdir(t);return r?i.filter(isNotSystemJunk):i}catch(e){return e}}const c=[".AppleDB",".AppleDesktop",".AppleDouble",".DS_Store",".DocumentRevisions-V100",".LSOverride",".Spotlight-V100",".TemporaryItems",".Trashes",".VolumeIcon.icns",".apdisk",".com.apple.timemachine.donotpresent",".fseventsd","Network Trash Folder","Temporary Items","$RECYCLE.BIN/","Desktop.ini","Thumbs.db","Thumbs.db:encryptable","desktop.ini","ehthumbs.db","ehthumbs_vista.db",".directory"];async function dirIsEmpty(e,t=!0){const r=await dirIsReadable(e);if(!0!==r)throw new Error(r.message,function errorExtractOptions(e){return e instanceof Error?"code"in e&&"errno"in e&&"path"in e&&"syscall"in e?{cause:{code:e.code,values:{errno:e.errno,path:e.path,syscall:e.syscall}}}:void 0:{cause:e}}(r));let i=await listContents(e);if(i instanceof Error)throw i;return 0===i.length||!!t&&function isEmptyContent(e){const t=new Set(e);return e.length=0,t.forEach(e=>{for(const r of c)e&&(e===r||e.match(RegExp(r)))&&t.delete(e)}),0===t.size}(i)}async function dirIsExecutable(e){return accessWrapper(r.constants.X_OK,e)}async function dirIsVisible(e){return accessWrapper(r.constants.F_OK,e)}async function dirIsWritable(e){return accessWrapper(r.constants.W_OK,e)}async function hash(t,r){if(!i.getHashes().includes(r))throw new TypeError(`Digest algorithm [${r}] is not supported.`);return i.createHash(r).update(await e.readFile(t)).digest("hex")}async function hashCrc32(t){return function crc32(e){let t,r=[];for(let e=0;e<256;e++){t=e;for(let e=0;e<8;e++)t=1&t?3988292384^t>>>1:t>>>1;r[e]=t}let i=-1,s=0;for(;s<e.length;s++)i=i>>>8^r[255&(i^e.charCodeAt(s))];return(-1^i)>>>0}((await e.readFile(t)).toString("binary")).toString(16)}async function hashMd5(e){return hash(e,"md5")}async function hashSha1(e){return hash(e,"sha1")}async function hashSha256(e){return hash(e,"sha256")}async function hashSha512(e){return hash(e,"sha512")}async function size(t,r=!1){const i=await e.stat(t);return r?i.size.toLocaleString("en").replace(/,/g,"_"):i.size}async function fileIsExecutable(e){return accessWrapper(r.constants.X_OK,e)}async function fileIsReadable(e){return accessWrapper(r.constants.R_OK,e)}async function fileIsVisible(e){return accessWrapper(r.constants.F_OK,e)}async function fileIsWritable(e){return accessWrapper(r.constants.W_OK,e)}async function fileTruncate(t,r=0){try{return await e.truncate(t,r),!0}catch(e){return e}}function pathFrom(e,...r){let i;return i=Array.isArray(e)?e.map(e=>e.toString()):[e.toString()],r.length&&(i=i.concat(r.map(e=>e.toString()))),t.normalize(t.join(...i))}async function listDirectories(e){const t=await listContents(e);if(!Array.isArray(t))return t;return(await Promise.all(t.map(async t=>{const r=pathFrom(e,t),[i,s]=await getStatus(r);if(!s&&i.isDirectory())return t}))).filter(e=>e)}async function listFiles(e){const t=await listContents(e);if(!Array.isArray(t))return t;return(await Promise.all(t.map(async t=>{const r=pathFrom(e,t),[i,s]=await getStatus(r);if(!s&&!i.isDirectory())return t}))).filter(e=>e)}async function move(t,r){try{return await e.rename(t,r),!0}catch(e){return e}}const l=s.homedir();function absolutePath(e){return l?String(e).replace(/^~(?=$|\/|\\)/,l):String(e)}function absolutePathFrom(e,...r){let i;return i=Array.isArray(e)?e.map(e=>e.toString()):[e.toString()],r.length&&(i=i.concat(r.map(e=>e.toString()))),absolutePath(t.resolve(...i))}function fileExtension(e){return t.extname(e).substring(1)}function fileName(e){return t.parse(e).name}function fileNameExt(e){return t.basename(e)}function filePath(e){return t.dirname(e)}async function readFileToBase64(t){try{return(await e.readFile(t,"base64")).toString()}catch(e){return e}}async function readFileToBuffer(t){try{const r=await e.readFile(t,"binary");return Buffer.from(r)}catch(e){return e}}async function readFileToString(t){try{return(await e.readFile(absolutePath(t),"utf8")).toString()}catch(e){return e}}const u="win32"===process.platform;function rimraf(e,t,r){let i=0,s=r,o=t;"function"==typeof o&&(s=o,o={}),a(e,"remove(): missing path"),a.strictEqual(typeof e,"string","remove(): path should be a string"),a.strictEqual(typeof s,"function","remove(): callback function required"),a(o,"remove(): invalid options argument provided"),a.strictEqual(typeof o,"object","remove(): options should be object"),function defaults(e){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(t=>{e[t]=e[t]||n[t]}),e.maxBusyTries=e.maxBusyTries||3}(o),rimraf_(e,o,(function callbackRimraf(t){if(t){if(("EBUSY"===t.code||"ENOTEMPTY"===t.code||"EPERM"===t.code)&&i<o.maxBusyTries){i++;return void setTimeout(()=>rimraf_(e,o,callbackRimraf),100*i)}if("ENOENT"===t.code)return void s(null)}s(t)}))}function rimraf_(e,t,r){a(e),a(t),a("function"==typeof r),t.lstat(e,(i,s)=>i&&"ENOENT"===i.code?r(null):i&&"EPERM"===i.code&&u?fixWinEPERM(e,t,i,r):s&&s.isDirectory()?rmdir(e,t,i,r):void t.unlink(e,i=>{if(i){if("ENOENT"===i.code)return r(null);if("EPERM"===i.code)return u?fixWinEPERM(e,t,i,r):rmdir(e,t,i,r);if("EISDIR"===i.code)return rmdir(e,t,i,r)}return r(i)}))}function fixWinEPERM(e,t,r,i){return a(e),a(t),a("function"==typeof i),r&&a(r instanceof Error),t.chmod(e,438,s=>{s?"ENOENT"===s.code?i(null):i(r):t.stat(e,(s,n)=>{s?"ENOENT"===s.code?i(null):i(r):n.isDirectory()?rmdir(e,t,r,i):t.unlink(e,i)})}),null}function rmdir(e,r,i,s){return a(e),a(r),i&&a(i instanceof Error),a("function"==typeof s),r.rmdir(e,n=>{!n||"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code?n&&"ENOTDIR"===n.code?s(i):s(n):function removeSubPath(e,r,i){a(e),a(r),a("function"==typeof i),r.readdir(e,(s,n)=>{if(s)return i(s);let a,o=n.length;if(0===o)return r.rmdir(e,i);n.forEach(s=>{rimraf(t.join(e,s),r,t=>{a||(t?i(a=t):(--o,0===o&&r.rmdir(e,i)))})})})}(e,r,s)}),null}async function remove(e){return new Promise(t=>{rimraf(e,{},e=>{e?t(e):t()})})}function removeNonBlocking(e){remove(e).then(()=>{}).catch(()=>{})}async function removeSilent(t,r){try{await e.rm(t,{force:!0,recursive:!0,...r})}catch(e){}}async function getLinkStatus(t){try{return[await e.lstat(t)]}catch(e){return[void 0,e]}}async function isDirExists(e){const[t,r]=await getStatus(e);return!r&&t.isDirectory()}async function isFileExists(e){const[t,r]=await getStatus(e);return!r&&t.isFile()}async function isPathExists(e){const[t]=await getStatus(e);return Boolean(t)}async function writeFileTail(e,t,r){if(!1===await isFileExists(e)){const t=await createFile(e);if(!0!==t)return t}const i=await readFileToString(e);return i instanceof Error?i:new Promise((s,n)=>{setTimeout(()=>{writeFile(e,`${String(i)}${String(t)}`,r).then(()=>{s(!0)}).catch(e=>{n(e)})},1)})}function isObjectLike(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function collectionSortKeys(e,t=!0){if(!isObjectLike(e))return Array.isArray(e)?e.map(e=>collectionSortKeys(e,t)):e;const r=function objectKeys(e){return Object.keys(e).sort((e,t)=>e.localeCompare(t))}(e);return r.length?r.reduce((r,i)=>(t&&isObjectLike(e[i])||t&&Array.isArray(e[i])?r[i]=collectionSortKeys(e[i],t):r[i]=e[i],r),{}):e}async function writeJSON(e,t,r,i){let s,n=t;try{i?(i.sort&&(n=isObjectLike(t)?collectionSortKeys(JSON.parse(JSON.stringify(t))):Array.isArray(t)?JSON.parse(JSON.stringify(t)):t),i.space&&(s=JSON.stringify(n,null,i.space))):s=JSON.stringify(n)}catch(e){return e}return writeFile(e,s,r)}function _defineProperty(e,t,r){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}exports.HileSystemLocal=class HileSystemLocal{constructor(){_defineProperty(this,"absolutePathFrom",absolutePathFrom),_defineProperty(this,"createDirectory",createDirectory),_defineProperty(this,"createFile",createFile),_defineProperty(this,"dirIsExecutable",dirIsExecutable),_defineProperty(this,"dirIsReadable",dirIsReadable),_defineProperty(this,"dirIsVisible",dirIsVisible),_defineProperty(this,"dirIsWritable",dirIsWritable),_defineProperty(this,"dirIsEmpty",dirIsEmpty),_defineProperty(this,"getLinkStatus",getLinkStatus),_defineProperty(this,"getStatus",getStatus),_defineProperty(this,"isDirExists",isDirExists),_defineProperty(this,"isFileExists",isFileExists),_defineProperty(this,"isPathExists",isPathExists),_defineProperty(this,"fileExtension",fileExtension),_defineProperty(this,"fileName",fileName),_defineProperty(this,"fileNameExt",fileNameExt),_defineProperty(this,"filePath",filePath),_defineProperty(this,"fileIsExecutable",fileIsExecutable),_defineProperty(this,"fileIsReadable",fileIsReadable),_defineProperty(this,"fileIsVisible",fileIsVisible),_defineProperty(this,"fileIsWritable",fileIsWritable),_defineProperty(this,"fileTruncate",fileTruncate),_defineProperty(this,"hash",hash),_defineProperty(this,"hashCrc32",hashCrc32),_defineProperty(this,"hashMd5",hashMd5),_defineProperty(this,"hashSha1",hashSha1),_defineProperty(this,"hashSha256",hashSha256),_defineProperty(this,"hashSha512",hashSha512),_defineProperty(this,"listContents",listContents),_defineProperty(this,"listDirectories",listDirectories),_defineProperty(this,"listFiles",listFiles),_defineProperty(this,"move",move),_defineProperty(this,"pathFrom",pathFrom),_defineProperty(this,"readFileToBase64",readFileToBase64),_defineProperty(this,"readFileToBuffer",readFileToBuffer),_defineProperty(this,"readFileToString",readFileToString),_defineProperty(this,"remove",remove),_defineProperty(this,"removeNonBlocking",removeNonBlocking),_defineProperty(this,"removeSilent",removeSilent),_defineProperty(this,"size",size),_defineProperty(this,"writeFile",writeFile),_defineProperty(this,"writeFileTail",writeFileTail),_defineProperty(this,"writeJSON",writeJSON)}},exports.absolutePathFrom=absolutePathFrom,exports.createDirectory=createDirectory,exports.createFile=createFile,exports.dirIsEmpty=dirIsEmpty,exports.dirIsExecutable=dirIsExecutable,exports.dirIsReadable=dirIsReadable,exports.dirIsVisible=dirIsVisible,exports.dirIsWritable=dirIsWritable,exports.fileExtension=fileExtension,exports.fileIsExecutable=fileIsExecutable,exports.fileIsReadable=fileIsReadable,exports.fileIsVisible=fileIsVisible,exports.fileIsWritable=fileIsWritable,exports.fileName=fileName,exports.fileNameExt=fileNameExt,exports.filePath=filePath,exports.fileTruncate=fileTruncate,exports.getLinkStatus=getLinkStatus,exports.getStatus=getStatus,exports.hash=hash,exports.hashCrc32=hashCrc32,exports.hashMd5=hashMd5,exports.hashSha1=hashSha1,exports.hashSha256=hashSha256,exports.hashSha512=hashSha512,exports.isDirExists=isDirExists,exports.isFileExists=isFileExists,exports.isPathExists=isPathExists,exports.listContents=listContents,exports.listDirectories=listDirectories,exports.listFiles=listFiles,exports.move=move,exports.pathFrom=pathFrom,exports.readFileToBase64=readFileToBase64,exports.readFileToBuffer=readFileToBuffer,exports.readFileToString=readFileToString,exports.remove=remove,exports.removeNonBlocking=removeNonBlocking,exports.removeSilent=removeSilent,exports.size=size,exports.writeFile=writeFile,exports.writeFileTail=writeFileTail,exports.writeJSON=writeJSON;
//# sourceMappingURL=index.cjs.map
